# STM32机器人小狗 - 快速烧录指南

## 🎯 当前状态
✅ **设备连接**: 已检测到USB-SERIAL CH340 (COM3)
⚠️ **编译环境**: 需要安装ARM开发工具链

## 🚀 快速开始 (推荐方案)

### 方案一：使用STM32CubeIDE (最简单)

1. **下载安装STM32CubeIDE**
   - 访问：https://www.st.com/zh/development-tools/stm32cubeide.html
   - 下载适用于Windows的版本
   - 安装时选择包含所有组件

2. **烧录测试程序**
   ```batch
   # 双击运行
   烧录测试程序.bat
   ```

### 方案二：使用预编译的HEX文件 (最快速)

如果你不想安装完整的开发环境，可以直接使用预编译的测试程序：

1. **下载预编译测试程序**
   - 下载测试程序HEX文件：[robot_dog_test.hex](link-to-hex-file)

2. **使用串口烧录工具**
   ```batch
   # 下载并安装 stm32flash
   # 下载地址：https://sourceforge.net/projects/stm32flash/

   # 烧录命令
   stm32flash -w robot_dog_test.hex -v -g 0x0 COM3
   ```

### 方案三：使用STM32CubeProgrammer

1. **安装STM32CubeProgrammer**
   - 下载：https://www.st.com/zh/development-tools/stm32cubeprog.html

2. **烧录命令**
   ```batch
   STM32_Programmer_CLI.exe -c port=COM3 br=115200 -w robot_dog_test.hex -v -rst
   ```

## 🔧 烧录前准备

### 1. 设备准备
- ✅ USB数据线连接
- ✅ 设备上电 (LED指示灯亮起)
- ✅ 确认COM3端口可用

### 2. 进入烧录模式
**重要**: STM32需要进入烧录模式才能更新程序

#### 方法A: 硬件方式 (推荐)
1. 找到机器狗PCB上的 **BOOT0** 引脚或按钮
2. 将BOOT0连接到3.3V (或按住BOOT按钮)
3. 重新上电或按复位按钮
4. 此时设备进入烧录模式

#### 方法B: 软件方式
有些版本支持软件复位进入烧录模式

## 🎮 测试程序功能

烧录成功后，机器狗将运行测试程序，包含以下功能：

### 自动测试序列
1. **OLED显示测试** - 屏幕显示"Robot Dog Test"
2. **舵机测试** - 8个舵机逐个运动测试
3. **蓝牙通信测试** - 初始化蓝牙模块
4. **基础动作测试** - 执行站立、坐下等动作
5. **表情显示** - 显示各种表情图案

### 蓝牙控制命令
连接蓝牙后，发送以下数字命令：

| 命令 | 功能 | 说明 |
|------|------|------|
| `1` | 向前走 | 四腿协调前进 |
| `2` | 左转 | 原地左转90度 |
| `3` | 右转 | 原地右转90度 |
| `4` | 坐下 | 后腿弯曲坐下 |
| `5` | 站立 | 恢复站立姿势 |
| `6` | 跳舞 | 执行舞蹈动作 |
| `7` | 摇尾巴 | 尾巴摆动 |
| `8` | 打招呼 | 前腿抬起动作 |
| `9` | 重新测试 | 重启自动测试 |

### 蓝牙连接设置
- **设备名称**: RobotDog_Test
- **波特率**: 9600
- **数据格式**: 8N1 (8数据位，无校验，1停止位)

## 🔍 故障排除

### 问题1: 烧录失败
**可能原因及解决方案:**
1. **未进入烧录模式**
   - 确保BOOT0引脚已正确设置
   - 尝试重新上电

2. **串口被占用**
   ```batch
   # 检查串口状态
   mode COM3
   ```

3. **驱动问题**
   - 重新安装CH340驱动
   - 检查设备管理器

### 问题2: 烧录后无响应
**检查清单:**
- ✅ OLED屏幕是否有显示
- ✅ LED指示灯状态
- ✅ 舵机是否有轻微抖动
- ✅ 蓝牙模块是否可发现

### 问题3: 蓝牙连接失败
**解决步骤:**
1. 检查蓝牙模块供电
2. 确认波特率设置 (9600)
3. 重新配对蓝牙设备
4. 使用串口调试工具测试

## 📱 推荐测试工具

### 蓝牙串口工具
- **PuTTY** - 简单的串口终端
- **Arduino IDE串口监视器** - 方便的调试工具
- **CoolTerm** - 功能丰富的串口工具
- **手机蓝牙APP** - "Serial Bluetooth Terminal"

### 测试流程
1. 烧录测试程序
2. 观察OLED显示和自动测试
3. 连接蓝牙
4. 发送命令测试各项功能
5. 记录测试结果

## 🎯 验收标准

测试程序运行正常的标志：
- ✅ OLED屏幕显示 "Robot Dog Test"
- ✅ 舵机能够响应测试序列
- ✅ 蓝牙设备可被发现和连接
- ✅ 发送命令后机器狗有相应动作
- ✅ 表情和动画正常显示

## 📞 下一步

测试验证成功后，你可以：
1. **自定义动作** - 修改动作序列
2. **添加新功能** - 集成传感器
3. **优化算法** - 改进运动控制
4. **开发应用** - 创建手机控制APP

---

**🎉 祝你测试顺利！如有问题，可以查看详细的开发文档。**
